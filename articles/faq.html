<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gwasrapidd">
<title>Frequently asked questions • gwasrapidd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Frequently asked questions">
<meta property="og:description" content="gwasrapidd">
<meta property="og:image" content="https://rmagno.eu/gwasrapidd/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gwasrapidd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.13</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/gwasrapidd.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bmi_variants.html">Variants associated with Body Mass Index (BMI)</a>
    <a class="dropdown-item" href="../articles/faq.html">Frequently asked questions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ramiromagno/gwasrapidd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="faq_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Frequently asked questions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ramiromagno/gwasrapidd/blob/HEAD/vignettes/faq.Rmd" class="external-link"><code>vignettes/faq.Rmd</code></a></small>
      <div class="d-none name"><code>faq.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="how-to-be-sure-that-i-can-establish-a-connection-to-the-gwas-catalog-server">1 | How to be sure that I can establish a connection to the GWAS Catalog server?<a class="anchor" aria-label="anchor" href="#how-to-be-sure-that-i-can-establish-a-connection-to-the-gwas-catalog-server"></a>
</h2>
<p>You can check that gwasrapidd is able to connect to <a href="https://www.ebi.ac.uk" class="external-link">https://www.ebi.ac.uk</a> by making a connection attempt with the function <code><a href="../reference/is_ebi_reachable.html">is_ebi_reachable()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_ebi_reachable.html">is_ebi_reachable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Returns <code>TRUE</code> if the connection is possible, or <code>FALSE</code> otherwise. If the connection is not possible, use the parameter <code>chatty = TRUE</code> to learn at what point the connection is failing.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_ebi_reachable.html">is_ebi_reachable</a></span><span class="op">(</span>chatty <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-resources-is-the-gwas-catalog-database-currently-mapped-against">2 | What resources is the GWAS Catalog database currently mapped against?<a class="anchor" aria-label="anchor" href="#what-resources-is-the-gwas-catalog-database-currently-mapped-against"></a>
</h2>
<p>The GWAS Catalog is mapped against <a href="https://www.ensembl.org" class="external-link">Ensembl</a>, <a href="https://www.ncbi.nlm.nih.gov/snp/" class="external-link">dbSNP</a> and a specific <a href="https://www.ncbi.nlm.nih.gov/grc/human" class="external-link">assembly version</a> of the human genome. You can get this info with <code><a href="../reference/get_metadata.html">get_metadata()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_metadata.html">get_metadata</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $ensembl_release_number</span></span>
<span><span class="co">#&gt; [1] 107</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $genome_build_version</span></span>
<span><span class="co">#&gt; [1] "GRCh38.p13"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dbsnp_version</span></span>
<span><span class="co">#&gt; [1] 154</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $usage_start_date</span></span>
<span><span class="co">#&gt; [1] "2022-07-12 13:00:04 UTC"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-perform-batch-search-with-gwasrapidd">3 | How to perform batch search with gwasrapidd?<a class="anchor" aria-label="anchor" href="#how-to-perform-batch-search-with-gwasrapidd"></a>
</h2>
<p>The four main retrieval functions <code><a href="../reference/get_studies.html">get_studies()</a></code>, <code><a href="../reference/get_associations.html">get_associations()</a></code>, <code><a href="../reference/get_variants.html">get_variants()</a></code>, and <code><a href="../reference/get_traits.html">get_traits()</a></code> allow to search by multiple values for the same search criterion. You only need to pass a vector of queries to each search criterion parameter. Here are some simple examples.</p>
<p>Get studies by study identifiers (GCST002420 or GCST000392):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_studies.html">get_studies</a></span><span class="op">(</span>study_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GCST002420'</span>, <span class="st">'GCST000392'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "studies"</span></span>
<span><span class="co">#&gt; Slot "studies":</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 13</span></span>
<span><span class="co">#&gt;   study_id repor…¹ initi…² repli…³ gxe   gxg   snp_c…⁴ quali…⁵ imputed pooled</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;lgl&gt; &lt;lgl&gt;   &lt;int&gt; &lt;chr&gt;   &lt;lgl&gt;   &lt;lgl&gt; </span></span>
<span><span class="co">#&gt; 1 GCST002… Binge … 206 Eu… 70 Eur… FALSE FALSE 8466825 &lt;NA&gt;    TRUE    FALSE </span></span>
<span><span class="co">#&gt; 2 GCST000… Type 1… 7,514 … 4,267 … FALSE FALSE  841622 &lt;NA&gt;    TRUE    FALSE </span></span>
<span><span class="co">#&gt; # … with 3 more variables: study_design_comment &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   full_pvalue_set &lt;lgl&gt;, user_requested &lt;lgl&gt;, and abbreviated variable</span></span>
<span><span class="co">#&gt; #   names ¹​reported_trait, ²​initial_sample_size, ³​replication_sample_size,</span></span>
<span><span class="co">#&gt; #   ⁴​snp_count, ⁵​qualifier</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "genotyping_techs":</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;   study_id   genotyping_technology       </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                       </span></span>
<span><span class="co">#&gt; 1 GCST002420 Genome-wide genotyping array</span></span>
<span><span class="co">#&gt; 2 GCST000392 Genome-wide genotyping array</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "platforms":</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span><span class="co">#&gt;   study_id   manufacturer</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;       </span></span>
<span><span class="co">#&gt; 1 GCST002420 Affymetrix  </span></span>
<span><span class="co">#&gt; 2 GCST000392 Illumina    </span></span>
<span><span class="co">#&gt; 3 GCST000392 Affymetrix  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "ancestries":</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 4</span></span>
<span><span class="co">#&gt;   study_id   ancestry_id type        number_of_individuals</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;                       &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 GCST002420           1 initial                       929</span></span>
<span><span class="co">#&gt; 2 GCST002420           2 replication                   828</span></span>
<span><span class="co">#&gt; 3 GCST000392           1 initial                     16559</span></span>
<span><span class="co">#&gt; 4 GCST000392           2 replication                 13279</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "ancestral_groups":</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   study_id   ancestry_id ancestral_group</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;          </span></span>
<span><span class="co">#&gt; 1 GCST002420           1 European       </span></span>
<span><span class="co">#&gt; 2 GCST002420           2 European       </span></span>
<span><span class="co">#&gt; 3 GCST000392           1 European       </span></span>
<span><span class="co">#&gt; 4 GCST000392           2 European       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "countries_of_origin":</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   study_id   ancestry_id country_name major_area region</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 GCST002420           1 &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  </span></span>
<span><span class="co">#&gt; 2 GCST002420           2 &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "countries_of_recruitment":</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 5</span></span>
<span><span class="co">#&gt;   study_id   ancestry_id country_name major_area       region         </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;          </span></span>
<span><span class="co">#&gt; 1 GCST002420           1 U.S.         Northern America &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 2 GCST002420           2 U.S.         Northern America &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 3 GCST000392           1 U.K.         Europe           Northern Europe</span></span>
<span><span class="co">#&gt; 4 GCST000392           2 U.K.         Europe           Northern Europe</span></span>
<span><span class="co">#&gt; 5 GCST000392           2 Denmark      Europe           Northern Europe</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "publications":</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span><span class="co">#&gt;   study_id   pubmed_id publication_date publication     title autho…¹ autho…²</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;int&gt; &lt;date&gt;           &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1 GCST002420  24882193 2014-04-19       J Affect Disord Bipo… Winham… 0000-0…</span></span>
<span><span class="co">#&gt; 2 GCST000392  19430480 2009-05-10       Nat Genet       Geno… Barret… &lt;NA&gt;   </span></span>
<span><span class="co">#&gt; # … with abbreviated variable names ¹​author_fullname, ²​author_orcid</span></span></code></pre></div>
<p>Get associations by variant identifiers (rs3798440 or rs7329174):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_associations.html">get_associations</a></span><span class="op">(</span>variant_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'rs3798440'</span>, <span class="st">'rs7329174'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "associations"</span></span>
<span><span class="co">#&gt; Slot "associations":</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 17</span></span>
<span><span class="co">#&gt;   associatio…¹ pvalue pvalu…² pvalu…³ pvalu…⁴ multi…⁵ snp_i…⁶ snp_t…⁷ stand…⁸</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;     &lt;int&gt;   &lt;int&gt; &lt;lgl&gt;   &lt;lgl&gt;   &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 24299710      3e-10 &lt;NA&gt;          3     -10 FALSE   TRUE    novel        NA</span></span>
<span><span class="co">#&gt; 2 16617         1e- 8 &lt;NA&gt;          1      -8 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; 3 26451         8e- 9 &lt;NA&gt;          8      -9 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; 4 26394         6e- 6 &lt;NA&gt;          6      -6 FALSE   FALSE   known        NA</span></span>
<span><span class="co">#&gt; 5 17433639      3e- 6 (Chine…       3      -6 FALSE   FALSE   known        NA</span></span>
<span><span class="co">#&gt; 6 92481688      3e- 6 &lt;NA&gt;          3      -6 FALSE   FALSE   known        NA</span></span>
<span><span class="co">#&gt; # … with 8 more variables: range &lt;chr&gt;, or_per_copy_number &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   beta_number &lt;dbl&gt;, beta_unit &lt;chr&gt;, beta_direction &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   beta_description &lt;chr&gt;, last_mapping_date &lt;dttm&gt;,</span></span>
<span><span class="co">#&gt; #   last_update_date &lt;dttm&gt;, and abbreviated variable names ¹​association_id,</span></span>
<span><span class="co">#&gt; #   ²​pvalue_description, ³​pvalue_mantissa, ⁴​pvalue_exponent,</span></span>
<span><span class="co">#&gt; #   ⁵​multiple_snp_haplotype, ⁶​snp_interaction, ⁷​snp_type, ⁸​standard_error</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "loci":</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 4</span></span>
<span><span class="co">#&gt;   association_id locus_id haplotype_snp_count description          </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;             &lt;int&gt;               &lt;int&gt; &lt;chr&gt;                </span></span>
<span><span class="co">#&gt; 1 24299710              1                  NA SNP x SNP interaction</span></span>
<span><span class="co">#&gt; 2 24299710              2                  NA SNP x SNP interaction</span></span>
<span><span class="co">#&gt; 3 16617                 1                  NA Single variant       </span></span>
<span><span class="co">#&gt; 4 26451                 1                  NA Single variant       </span></span>
<span><span class="co">#&gt; 5 26394                 1                  NA Single variant       </span></span>
<span><span class="co">#&gt; 6 17433639              1                  NA Single variant       </span></span>
<span><span class="co">#&gt; 7 92481688              1                  NA Single variant       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "risk_alleles":</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 7</span></span>
<span><span class="co">#&gt;   association_id locus_id variant_id risk_allele risk_frequ…¹ genom…² limit…³</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt; &lt;lgl&gt;   &lt;lgl&gt;  </span></span>
<span><span class="co">#&gt; 1 24299710              1 rs3798440  A                 NA     TRUE    FALSE  </span></span>
<span><span class="co">#&gt; 2 24299710              2 rs9350602  C                 NA     TRUE    FALSE  </span></span>
<span><span class="co">#&gt; 3 16617                 1 rs7329174  G                 NA     NA      NA     </span></span>
<span><span class="co">#&gt; 4 26451                 1 rs7329174  G                 NA     NA      NA     </span></span>
<span><span class="co">#&gt; 5 26394                 1 rs7329174  G                 NA     NA      NA     </span></span>
<span><span class="co">#&gt; 6 17433639              1 rs7329174  &lt;NA&gt;               0.211 FALSE   FALSE  </span></span>
<span><span class="co">#&gt; 7 92481688              1 rs7329174  G                 NA     FALSE   FALSE  </span></span>
<span><span class="co">#&gt; # … with abbreviated variable names ¹​risk_frequency, ²​genome_wide,</span></span>
<span><span class="co">#&gt; #   ³​limited_list</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "genes":</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 3</span></span>
<span><span class="co">#&gt;    association_id locus_id gene_name   </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;       </span></span>
<span><span class="co">#&gt;  1 24299710              1 MYO6        </span></span>
<span><span class="co">#&gt;  2 24299710              2 MYO6        </span></span>
<span><span class="co">#&gt;  3 16617                 1 ELF1        </span></span>
<span><span class="co">#&gt;  4 26451                 1 WBP4        </span></span>
<span><span class="co">#&gt;  5 26451                 1 ELF1        </span></span>
<span><span class="co">#&gt;  6 26451                 1 microRNA2276</span></span>
<span><span class="co">#&gt;  7 26451                 1 SLC25A15    </span></span>
<span><span class="co">#&gt;  8 26394                 1 ELF1        </span></span>
<span><span class="co">#&gt;  9 17433639              1 ELF1        </span></span>
<span><span class="co">#&gt; 10 92481688              1 &lt;NA&gt;        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "ensembl_ids":</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 4</span></span>
<span><span class="co">#&gt;    association_id locus_id gene_name    ensembl_id     </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;          </span></span>
<span><span class="co">#&gt;  1 24299710              1 MYO6         ENSG00000196586</span></span>
<span><span class="co">#&gt;  2 24299710              2 MYO6         ENSG00000196586</span></span>
<span><span class="co">#&gt;  3 16617                 1 ELF1         ENSG00000120690</span></span>
<span><span class="co">#&gt;  4 26451                 1 WBP4         ENSG00000120688</span></span>
<span><span class="co">#&gt;  5 26451                 1 ELF1         ENSG00000120690</span></span>
<span><span class="co">#&gt;  6 26451                 1 microRNA2276 &lt;NA&gt;           </span></span>
<span><span class="co">#&gt;  7 26451                 1 SLC25A15     ENSG00000102743</span></span>
<span><span class="co">#&gt;  8 26394                 1 ELF1         ENSG00000120690</span></span>
<span><span class="co">#&gt;  9 17433639              1 ELF1         ENSG00000120690</span></span>
<span><span class="co">#&gt; 10 92481688              1 &lt;NA&gt;         &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "entrez_ids":</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 4</span></span>
<span><span class="co">#&gt;    association_id locus_id gene_name    entrez_id</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;    </span></span>
<span><span class="co">#&gt;  1 24299710              1 MYO6         4646     </span></span>
<span><span class="co">#&gt;  2 24299710              2 MYO6         4646     </span></span>
<span><span class="co">#&gt;  3 16617                 1 ELF1         1997     </span></span>
<span><span class="co">#&gt;  4 26451                 1 WBP4         11193    </span></span>
<span><span class="co">#&gt;  5 26451                 1 ELF1         1997     </span></span>
<span><span class="co">#&gt;  6 26451                 1 microRNA2276 &lt;NA&gt;     </span></span>
<span><span class="co">#&gt;  7 26451                 1 SLC25A15     10166    </span></span>
<span><span class="co">#&gt;  8 26394                 1 ELF1         1997     </span></span>
<span><span class="co">#&gt;  9 17433639              1 ELF1         1997     </span></span>
<span><span class="co">#&gt; 10 92481688              1 &lt;NA&gt;         &lt;NA&gt;</span></span></code></pre></div>
<p>Get associations by traits (braces or binge eating or gambling):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_associations.html">get_associations</a></span><span class="op">(</span>efo_trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'braces'</span>, <span class="st">'binge eating'</span>, <span class="st">'gambling'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "associations"</span></span>
<span><span class="co">#&gt; Slot "associations":</span></span>
<span><span class="co">#&gt; # A tibble: 14 × 17</span></span>
<span><span class="co">#&gt;    associati…¹ pvalue pvalu…² pvalu…³ pvalu…⁴ multi…⁵ snp_i…⁶ snp_t…⁷ stand…⁸</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;     &lt;int&gt;   &lt;int&gt; &lt;lgl&gt;   &lt;lgl&gt;   &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 15608         4e-7 (brace…       4      -7 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  2 44592         9e-7 &lt;NA&gt;          9      -7 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  3 44589         1e-6 &lt;NA&gt;          1      -6 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  4 44590         4e-6 &lt;NA&gt;          4      -6 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  5 27460823      1e-6 &lt;NA&gt;          1      -6 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  6 27460811      1e-7 &lt;NA&gt;          1      -7 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  7 27460817      7e-7 &lt;NA&gt;          7      -7 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  8 27460805      3e-8 &lt;NA&gt;          3      -8 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt;  9 27460830      1e-6 &lt;NA&gt;          1      -6 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; 10 27460844      1e-8 &lt;NA&gt;          1      -8 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; 11 27460858      3e-7 &lt;NA&gt;          3      -7 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; 12 27460864      3e-7 &lt;NA&gt;          3      -7 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; 13 27460870      1e-6 &lt;NA&gt;          1      -6 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; 14 27460851      9e-8 &lt;NA&gt;          9      -8 FALSE   FALSE   novel        NA</span></span>
<span><span class="co">#&gt; # … with 8 more variables: range &lt;chr&gt;, or_per_copy_number &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   beta_number &lt;dbl&gt;, beta_unit &lt;chr&gt;, beta_direction &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   beta_description &lt;chr&gt;, last_mapping_date &lt;dttm&gt;,</span></span>
<span><span class="co">#&gt; #   last_update_date &lt;dttm&gt;, and abbreviated variable names ¹​association_id,</span></span>
<span><span class="co">#&gt; #   ²​pvalue_description, ³​pvalue_mantissa, ⁴​pvalue_exponent,</span></span>
<span><span class="co">#&gt; #   ⁵​multiple_snp_haplotype, ⁶​snp_interaction, ⁷​snp_type, ⁸​standard_error</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "loci":</span></span>
<span><span class="co">#&gt; # A tibble: 14 × 4</span></span>
<span><span class="co">#&gt;    association_id locus_id haplotype_snp_count description   </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt;               &lt;int&gt; &lt;chr&gt;         </span></span>
<span><span class="co">#&gt;  1 15608                 1                  NA Single variant</span></span>
<span><span class="co">#&gt;  2 44592                 1                  NA Single variant</span></span>
<span><span class="co">#&gt;  3 44589                 1                  NA Single variant</span></span>
<span><span class="co">#&gt;  4 44590                 1                  NA Single variant</span></span>
<span><span class="co">#&gt;  5 27460823              1                  NA Single variant</span></span>
<span><span class="co">#&gt;  6 27460811              1                  NA Single variant</span></span>
<span><span class="co">#&gt;  7 27460817              1                  NA Single variant</span></span>
<span><span class="co">#&gt;  8 27460805              1                  NA Single variant</span></span>
<span><span class="co">#&gt;  9 27460830              1                  NA Single variant</span></span>
<span><span class="co">#&gt; 10 27460844              1                  NA Single variant</span></span>
<span><span class="co">#&gt; 11 27460858              1                  NA Single variant</span></span>
<span><span class="co">#&gt; 12 27460864              1                  NA Single variant</span></span>
<span><span class="co">#&gt; 13 27460870              1                  NA Single variant</span></span>
<span><span class="co">#&gt; 14 27460851              1                  NA Single variant</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "risk_alleles":</span></span>
<span><span class="co">#&gt; # A tibble: 14 × 7</span></span>
<span><span class="co">#&gt;    association_id locus_id variant_id  risk_allele risk_fre…¹ genom…² limit…³</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   &lt;lgl&gt;  </span></span>
<span><span class="co">#&gt;  1 15608                 1 rs1535480   &lt;NA&gt;             NA    NA      NA     </span></span>
<span><span class="co">#&gt;  2 44592                 1 rs6006893   &lt;NA&gt;             NA    NA      NA     </span></span>
<span><span class="co">#&gt;  3 44589                 1 rs10198175  &lt;NA&gt;             NA    NA      NA     </span></span>
<span><span class="co">#&gt;  4 44590                 1 rs13233490  &lt;NA&gt;             NA    NA      NA     </span></span>
<span><span class="co">#&gt;  5 27460823              1 rs182107583 C                 0.04 FALSE   FALSE  </span></span>
<span><span class="co">#&gt;  6 27460811              1 rs7904579   G                 0.37 FALSE   FALSE  </span></span>
<span><span class="co">#&gt;  7 27460817              1 rs1950038   T                 0.3  FALSE   FALSE  </span></span>
<span><span class="co">#&gt;  8 27460805              1 rs726170    T                 0.12 FALSE   FALSE  </span></span>
<span><span class="co">#&gt;  9 27460830              1 rs76087671  T                 0.05 FALSE   FALSE  </span></span>
<span><span class="co">#&gt; 10 27460844              1 rs111940429 T                 0.04 FALSE   FALSE  </span></span>
<span><span class="co">#&gt; 11 27460858              1 rs7337127   T                 0.15 FALSE   FALSE  </span></span>
<span><span class="co">#&gt; 12 27460864              1 rs145763646 A                 0.1  FALSE   FALSE  </span></span>
<span><span class="co">#&gt; 13 27460870              1 rs73057489  C                 0.07 FALSE   FALSE  </span></span>
<span><span class="co">#&gt; 14 27460851              1 rs17810023  T                 0.02 FALSE   FALSE  </span></span>
<span><span class="co">#&gt; # … with abbreviated variable names ¹​risk_frequency, ²​genome_wide,</span></span>
<span><span class="co">#&gt; #   ³​limited_list</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "genes":</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 3</span></span>
<span><span class="co">#&gt;    association_id locus_id gene_name   </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;       </span></span>
<span><span class="co">#&gt;  1 15608                 1 &lt;NA&gt;        </span></span>
<span><span class="co">#&gt;  2 44592                 1 PRR5        </span></span>
<span><span class="co">#&gt;  3 44589                 1 APOB        </span></span>
<span><span class="co">#&gt;  4 44590                 1 PER4        </span></span>
<span><span class="co">#&gt;  5 27460823              1 LOC101929321</span></span>
<span><span class="co">#&gt;  6 27460811              1 CUBN        </span></span>
<span><span class="co">#&gt;  7 27460817              1 Intergenic  </span></span>
<span><span class="co">#&gt;  8 27460805              1 PRR5        </span></span>
<span><span class="co">#&gt;  9 27460805              1 ARHGAP8     </span></span>
<span><span class="co">#&gt; 10 27460830              1 intergenic  </span></span>
<span><span class="co">#&gt; 11 27460844              1 AC096669.1  </span></span>
<span><span class="co">#&gt; 12 27460858              1 intergenic  </span></span>
<span><span class="co">#&gt; 13 27460864              1 SLC25A26    </span></span>
<span><span class="co">#&gt; 14 27460870              1 intergenic  </span></span>
<span><span class="co">#&gt; 15 27460851              1 RP11-250B2.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "ensembl_ids":</span></span>
<span><span class="co">#&gt; # A tibble: 16 × 4</span></span>
<span><span class="co">#&gt;    association_id locus_id gene_name    ensembl_id     </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;          </span></span>
<span><span class="co">#&gt;  1 15608                 1 &lt;NA&gt;         &lt;NA&gt;           </span></span>
<span><span class="co">#&gt;  2 44592                 1 PRR5         ENSG00000186654</span></span>
<span><span class="co">#&gt;  3 44589                 1 APOB         ENSG00000084674</span></span>
<span><span class="co">#&gt;  4 44590                 1 PER4         &lt;NA&gt;           </span></span>
<span><span class="co">#&gt;  5 27460823              1 LOC101929321 &lt;NA&gt;           </span></span>
<span><span class="co">#&gt;  6 27460811              1 CUBN         ENSG00000107611</span></span>
<span><span class="co">#&gt;  7 27460817              1 Intergenic   &lt;NA&gt;           </span></span>
<span><span class="co">#&gt;  8 27460805              1 PRR5         ENSG00000186654</span></span>
<span><span class="co">#&gt;  9 27460805              1 ARHGAP8      ENSG00000241484</span></span>
<span><span class="co">#&gt; 10 27460830              1 intergenic   &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 11 27460844              1 AC096669.1   ENSG00000225588</span></span>
<span><span class="co">#&gt; 12 27460858              1 intergenic   &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 13 27460864              1 SLC25A26     ENSG00000282739</span></span>
<span><span class="co">#&gt; 14 27460864              1 SLC25A26     ENSG00000144741</span></span>
<span><span class="co">#&gt; 15 27460870              1 intergenic   &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 16 27460851              1 RP11-250B2.3 &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slot "entrez_ids":</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 4</span></span>
<span><span class="co">#&gt;    association_id locus_id gene_name    entrez_id</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;    </span></span>
<span><span class="co">#&gt;  1 15608                 1 &lt;NA&gt;         &lt;NA&gt;     </span></span>
<span><span class="co">#&gt;  2 44592                 1 PRR5         55615    </span></span>
<span><span class="co">#&gt;  3 44589                 1 APOB         338      </span></span>
<span><span class="co">#&gt;  4 44590                 1 PER4         &lt;NA&gt;     </span></span>
<span><span class="co">#&gt;  5 27460823              1 LOC101929321 101929321</span></span>
<span><span class="co">#&gt;  6 27460811              1 CUBN         8029     </span></span>
<span><span class="co">#&gt;  7 27460817              1 Intergenic   &lt;NA&gt;     </span></span>
<span><span class="co">#&gt;  8 27460805              1 PRR5         55615    </span></span>
<span><span class="co">#&gt;  9 27460805              1 ARHGAP8      23779    </span></span>
<span><span class="co">#&gt; 10 27460830              1 intergenic   &lt;NA&gt;     </span></span>
<span><span class="co">#&gt; 11 27460844              1 AC096669.1   &lt;NA&gt;     </span></span>
<span><span class="co">#&gt; 12 27460858              1 intergenic   &lt;NA&gt;     </span></span>
<span><span class="co">#&gt; 13 27460864              1 SLC25A26     115286   </span></span>
<span><span class="co">#&gt; 14 27460870              1 intergenic   &lt;NA&gt;     </span></span>
<span><span class="co">#&gt; 15 27460851              1 RP11-250B2.3 &lt;NA&gt;</span></span></code></pre></div>
<p>Get traits by PubMed identifiers (24882193 or 22780124):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_traits.html">get_traits</a></span><span class="op">(</span>pubmed_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'24882193'</span>, <span class="st">'22780124'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "traits"</span></span>
<span><span class="co">#&gt; Slot "traits":</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   efo_id      trait              uri                                 </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;              &lt;chr&gt;                               </span></span>
<span><span class="co">#&gt; 1 EFO_0005924 binge eating       http://www.ebi.ac.uk/efo/EFO_0005924</span></span>
<span><span class="co">#&gt; 2 EFO_0000289 bipolar disorder   http://www.ebi.ac.uk/efo/EFO_0000289</span></span>
<span><span class="co">#&gt; 3 EFO_0004699 gambling behaviour http://www.ebi.ac.uk/efo/EFO_0004699</span></span></code></pre></div>
<p>The only search parameters that are not vectorised are <code>user_requested</code> and <code>full_pvalue_set</code> from <code><a href="../reference/get_studies.html">get_studies()</a></code>. These parameters are not vectorised because they take boolean values (<code>TRUE</code> or <code>FALSE</code>) and thus only one of the values is sensical to be used as a query at a given time.</p>
</div>
<div class="section level2">
<h2 id="what-is-the-difference-between-a-trait-and-a-reported-trait">4 | What is the difference between a trait and a reported trait?<a class="anchor" aria-label="anchor" href="#what-is-the-difference-between-a-trait-and-a-reported-trait"></a>
</h2>
<p>There are two levels of trait description in the GWAS Catalog: (EFO) trait and reported trait.</p>
<p>Studies are assigned one or more terms from the <a href="https://www.ebi.ac.uk/efo/" class="external-link">Experimental Factor Ontology (EFO)</a>, i.e., an EFO trait, or simply trait, that best represents the phenotype under investigation.</p>
<p>In addition, each study is also assigned a free text reported trait. This is written by the GWAS Catalog curators and reflects the author language, and where necessary, it includes more specific and detailed description of the experimental design, e.g., interaction studies or studies with a background trait.</p>
<p>As an example take the study with accession identifier <code>GCST000206</code> by EM Behrens et al. (2008). We can get the EFO trait with <code><a href="../reference/get_traits.html">get_traits()</a></code> and the reported trait with <code><a href="../reference/get_studies.html">get_studies()</a></code>:</p>
<p>The (EFO) trait for the Behrens study is <code>chronic childhood arthritis</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">efo_trait</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_traits.html">get_traits</a></span><span class="op">(</span>study_id <span class="op">=</span> <span class="st">'GCST000206'</span><span class="op">)</span></span>
<span><span class="va">efo_trait</span><span class="op">@</span><span class="va">traits</span><span class="op">$</span><span class="va">trait</span></span>
<span><span class="co">#&gt; [1] "juvenile idiopathic arthritis"</span></span></code></pre></div>
<p>whereas the reported trait is <code>Arthritis (juvenile idiopathic)</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_studies.html">get_studies</a></span><span class="op">(</span>study_id <span class="op">=</span> <span class="st">'GCST000206'</span><span class="op">)</span></span>
<span><span class="va">study</span><span class="op">@</span><span class="va">studies</span><span class="op">$</span><span class="va">reported_trait</span></span>
<span><span class="co">#&gt; [1] "Arthritis (juvenile idiopathic)"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="genomic-coordinates-of-genomic-contexts-seem-to-be-wrong">5 | Genomic coordinates of genomic contexts seem to be wrong?<a class="anchor" aria-label="anchor" href="#genomic-coordinates-of-genomic-contexts-seem-to-be-wrong"></a>
</h2>
<p>The REST API response for variants contains an element named <em>genomic contexts</em>. This element is mapped onto the table <code>genomic_contexts</code> of a <a href="https://rmagno.eu/gwasrapidd/reference/variants-class.html">variants</a> S4 object.</p>
<p>Now, there is indeed a server-side bug with the column <code>chromosome_position</code> of the <code>genomic_contexts</code> table: the chromosome position returned is that of the variant and not of the gene (<em>genomic context</em>) as it should be.</p>
<p>The GWAS Catalog team is aware of this bug, and they plan to fix it, eventually. For the time being, just do not rely on <code>chromosome_position</code> of the <code>genomic_contexts</code> table.</p>
</div>
<div class="section level2">
<h2 id="how-to-search-for-variants-within-a-certain-genomic-region">6 | How to search for variants within a certain genomic region?<a class="anchor" aria-label="anchor" href="#how-to-search-for-variants-within-a-certain-genomic-region"></a>
</h2>
<div class="section level3">
<h3 id="single-genomic-range">Single genomic range<a class="anchor" aria-label="anchor" href="#single-genomic-range"></a>
</h3>
<p>For this you may use the function <code><a href="../reference/get_variants.html">get_variants()</a></code> with parameter <code>genomic_range</code>.</p>
<p>For example, to search for variants in chromosome Y in the interval 14692000–14695000, you start by defining a list of 3 elements: <code>chromosome</code>, <code>start</code> and <code>end</code> that specify your genomic range:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># 'chromosome' names are case sensitive, and should be uppercase.</span></span>
<span><span class="co"># 'start' and 'end' positions should be integer vectors.</span></span>
<span><span class="va">my_genomic_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  chromosome <span class="op">=</span> <span class="st">'Y'</span>,</span>
<span>  start <span class="op">=</span> <span class="fl">14692000L</span>,</span>
<span>  end <span class="op">=</span> <span class="fl">14695000L</span><span class="op">)</span></span></code></pre></div>
<p>Now you can use <code>my_genomic_range</code> to retrieve the variants:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_Y_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>genomic_range <span class="op">=</span> <span class="va">my_genomic_range</span><span class="op">)</span></span>
<span><span class="va">chr_Y_variants</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>, <span class="st">'functional_class'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;   variant_id functional_class</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;           </span></span>
<span><span class="co">#&gt; 1 rs2115848  intron_variant</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-genomic-ranges">Multiple genomic ranges<a class="anchor" aria-label="anchor" href="#multiple-genomic-ranges"></a>
</h3>
<p>To search in multiple regions, construct your genomic range list with those locations just like in the previous example. For example, let’s search now for variants in chromosome X and Y, both in range 13000000–15000000:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_genomic_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  chromosome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X'</span>, <span class="st">'Y'</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13000000L</span>, <span class="fl">13000000L</span><span class="op">)</span>,</span>
<span>  end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15000000L</span>, <span class="fl">15000000L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_XY_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>genomic_range <span class="op">=</span> <span class="va">my_genomic_range</span><span class="op">)</span></span>
<span><span class="va">chr_XY_variants</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                           <span class="st">'chromosome_name'</span>,</span>
<span>                           <span class="st">'chromosome_position'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 22 × 3</span></span>
<span><span class="co">#&gt;    variant_id  chromosome_name chromosome_position</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;                         &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 rs111689944 X                          13494655</span></span>
<span><span class="co">#&gt;  2 rs73633565  X                          13459192</span></span>
<span><span class="co">#&gt;  3 rs5980075   X                          14932409</span></span>
<span><span class="co">#&gt;  4 rs142204301 X                          13358691</span></span>
<span><span class="co">#&gt;  5 rs2361151   X                          13503433</span></span>
<span><span class="co">#&gt;  6 rs35164803  X                          14911253</span></span>
<span><span class="co">#&gt;  7 rs12558341  X                          13695943</span></span>
<span><span class="co">#&gt;  8 rs138331350 X                          14841981</span></span>
<span><span class="co">#&gt;  9 rs66819623  X                          13936278</span></span>
<span><span class="co">#&gt; 10 rs61273829  X                          14150876</span></span>
<span><span class="co">#&gt; # … with 12 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="searching-variants-by-cytogenetic-regions">Searching variants by cytogenetic regions<a class="anchor" aria-label="anchor" href="#searching-variants-by-cytogenetic-regions"></a>
</h3>
<p>To search for variants within a cytogenetic band you can use the parameter <code>cytogenetic_band</code> of <code><a href="../reference/get_variants.html">get_variants()</a></code>. Here is an example, again for chromosome Y, using the cytogenetic band <code>'Yq11.221'</code> as query:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>cytogenetic_band <span class="op">=</span> <span class="st">'Yq11.221'</span><span class="op">)</span></span>
<span><span class="va">my_variants</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   variant_id chromosome_name chromosome_position</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                         &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 rs2115848  Y                          14692972</span></span>
<span><span class="co">#&gt; 2 rs2032658  Y                          13470103</span></span>
<span><span class="co">#&gt; 3 rs2032624  Y                          12914512</span></span></code></pre></div>
<p>How to know what are the cytogenetic bands for querying? We provide a dataset (dataframe) named <code>cytogenetic_bands</code> that you can use:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ?cytogenetic_bands for more details.</span></span>
<span><span class="va">cytogenetic_bands</span></span>
<span><span class="co">#&gt; # A tibble: 862 × 8</span></span>
<span><span class="co">#&gt;    cytogenetic_band chromosome    start      end length assem…¹ stain last_…²</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;            &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  </span></span>
<span><span class="co">#&gt;  1 1p36.33          1                 1  2300000  2.3e6 GRCh38  gneg  Thu Ju…</span></span>
<span><span class="co">#&gt;  2 1p36.32          1           2300001  5300000  3  e6 GRCh38  gpos… Thu Ju…</span></span>
<span><span class="co">#&gt;  3 1p36.31          1           5300001  7100000  1.8e6 GRCh38  gneg  Thu Ju…</span></span>
<span><span class="co">#&gt;  4 1p36.23          1           7100001  9100000  2  e6 GRCh38  gpos… Thu Ju…</span></span>
<span><span class="co">#&gt;  5 1p36.22          1           9100001 12500000  3.4e6 GRCh38  gneg  Thu Ju…</span></span>
<span><span class="co">#&gt;  6 1p36.21          1          12500001 15900000  3.4e6 GRCh38  gpos… Thu Ju…</span></span>
<span><span class="co">#&gt;  7 1p36.13          1          15900001 20100000  4.2e6 GRCh38  gneg  Thu Ju…</span></span>
<span><span class="co">#&gt;  8 1p36.12          1          20100001 23600000  3.5e6 GRCh38  gpos… Thu Ju…</span></span>
<span><span class="co">#&gt;  9 1p36.11          1          23600001 27600000  4  e6 GRCh38  gneg  Thu Ju…</span></span>
<span><span class="co">#&gt; 10 1p35.3           1          27600001 29900000  2.3e6 GRCh38  gpos… Thu Ju…</span></span>
<span><span class="co">#&gt; # … with 852 more rows, and abbreviated variable names ¹​assembly,</span></span>
<span><span class="co">#&gt; #   ²​last_download_date</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>Let’s say you want to search for all variants in the shorter arm (p) of chromosome 21, you can take advantage of the <code>cytogenetic_bands</code> to get all the corresponding cytogenetic band names:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install package dplyr if you do not have it.</span></span>
<span><span class="va">chr21_p_bands</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cytogenetic_bands</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^21p'</span>, <span class="va">cytogenetic_band</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">cytogenetic_band</span><span class="op">)</span></span>
<span><span class="va">chr21_p_bands</span></span>
<span><span class="co">#&gt; [1] "21p13"   "21p12"   "21p11.2" "21p11.1"</span></span></code></pre></div>
<p>Now search by <code>cytogenetic_band</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>cytogenetic_band <span class="op">=</span> <span class="va">chr21_p_bands</span><span class="op">)</span></span>
<span><span class="va">my_variants</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span>,</span>
<span>                       <span class="st">'chromosome_region'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 4</span></span>
<span><span class="co">#&gt;   variant_id  chromosome_name chromosome_position chromosome_region</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;            </span></span>
<span><span class="co">#&gt; 1 rs552964654 21                          9053097 21p11.2          </span></span>
<span><span class="co">#&gt; 2 rs240444    21                         10510446 21p11.2          </span></span>
<span><span class="co">#&gt; 3 rs10439884  21                         10540506 21p11.2          </span></span>
<span><span class="co">#&gt; 4 rs75275574  21                          9040338 21p11.2</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="genomic-range-for-an-entire-chromosome">7 | Genomic range for an entire chromosome?<a class="anchor" aria-label="anchor" href="#genomic-range-for-an-entire-chromosome"></a>
</h2>
<p>You can get the total length of a chromosome by using the provided data set: <code>cytogenetic_bands</code>. Here is an example for chromosome 15:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Install dplyr first.</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cytogenetic_bands</span>, <span class="va">chromosome</span> <span class="op">==</span> <span class="st">'15'</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>chromosome <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">chromosome</span><span class="op">)</span>,</span>
<span>                   start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">start</span><span class="op">)</span>,</span>
<span>                   end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">end</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;   chromosome start       end</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;int&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 15             1 101991189</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-keep-track-of-which-queries-generated-which-results">8 | How to keep track of which queries generated which results?<a class="anchor" aria-label="anchor" href="#how-to-keep-track-of-which-queries-generated-which-results"></a>
</h2>
<p>Currently, there is not an implemented solution in <a href="https://github.com/ramiromagno/gwasrapidd" class="external-link">gwasrapidd</a>. For example, if you search for variants by EFO identifier (<code>efo_id</code>):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_efo_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'EFO_0005543'</span>, <span class="st">'EFO_0004762'</span><span class="op">)</span></span>
<span><span class="va">my_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>efo_id <span class="op">=</span> <span class="va">my_efo_ids</span><span class="op">)</span></span>
<span><span class="va">my_variants</span><span class="op">@</span><span class="va">variants</span><span class="op">$</span><span class="va">variant_id</span></span>
<span><span class="co">#&gt;   [1] "rs11706832"  "rs498872"    "rs72714270"  "rs11599775"  "rs12803321" </span></span>
<span><span class="co">#&gt;   [6] "rs7125115"   "rs10069690"  "rs12752552"  "rs648044"    "rs111976262"</span></span>
<span><span class="co">#&gt;  [11] "rs11598018"  "rs4252707"   "rs688755"    "rs634537"    "rs78378222" </span></span>
<span><span class="co">#&gt;  [16] "rs4975538"   "rs2297433"   "rs55705857"  "rs320337"    "rs10852606" </span></span>
<span><span class="co">#&gt;  [21] "rs2297440"   "rs1938964"   "rs1106639"   "rs12076373"  "rs3772190"  </span></span>
<span><span class="co">#&gt;  [26] "rs2235573"   "rs10842893"  "rs7572263"   "rs2736100"   "rs80351950" </span></span>
<span><span class="co">#&gt;  [31] "rs5839764"   "rs77633900"  "rs3751667"   "rs7107785"   "rs72714236" </span></span>
<span><span class="co">#&gt;  [36] "rs10131032"  "rs4774756"   "rs4977756"   "rs9841110"   "rs6010620"  </span></span>
<span><span class="co">#&gt;  [41] "rs11233250"  "rs75061358"  "rs10927065"  "rs1275600"   "rs11979158" </span></span>
<span><span class="co">#&gt;  [46] "rs78355601"  "rs10411345"  "rs144085478" "rs12214617"  "rs181216459"</span></span>
<span><span class="co">#&gt;  [51] "rs118086804" "rs12456390"  "rs4714729"   "rs12199215"  "rs2639990"  </span></span>
<span><span class="co">#&gt;  [56] "rs9472155"   "rs144160960" "rs34528081"  "rs4082730"   "rs7763358"  </span></span>
<span><span class="co">#&gt;  [61] "rs55864163"  "rs9787438"   "rs150821445" "rs12445232"  "rs6598475"  </span></span>
<span><span class="co">#&gt;  [66] "rs10934631"  "rs6475938"   "rs6479877"   "rs6921438"   "rs10886366" </span></span>
<span><span class="co">#&gt;  [71] "rs10761741"  "rs114694170" "rs77961527"  "rs112215592" "rs117580153"</span></span>
<span><span class="co">#&gt;  [76] "rs73872715"  "rs13206436"  "rs4782371"   "rs4513773"   "rs186725382"</span></span>
<span><span class="co">#&gt;  [81] "rs139893147" "rs10153304"  "rs34524635"  "rs7043199"   "rs187918360"</span></span>
<span><span class="co">#&gt;  [86] "rs11639051"  "rs1740073"   "rs71779653"  "rs34881325"  "rs181558074"</span></span>
<span><span class="co">#&gt;  [91] "rs2375981"   "rs59706856"  "rs2304058"   "rs73418461"  "rs10761750" </span></span>
<span><span class="co">#&gt;  [96] "rs8045833"   "rs10761731"  "rs7030781"   "rs180936035" "rs550057"   </span></span>
<span><span class="co">#&gt; [101] "rs9332599"   "rs75455100"  "rs143479231" "rs10822155"  "rs7767396"  </span></span>
<span><span class="co">#&gt; [106] "rs191332118" "rs186066666" "rs11392719"  "rs6993770"   "rs61818787" </span></span>
<span><span class="co">#&gt; [111] "rs144820908" "rs61829244"  "rs6722871"   "rs10738760"</span></span></code></pre></div>
<p>So it is not immediately obvious which variants resulted from the query <code>'EFO_0005543'</code> or <code>'EFO_0004762'</code>.</p>
<p>A possible workaround is to make multiple independent queries and save your results in a list whose names are the respective queries:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install purrr first.</span></span>
<span><span class="co"># Add names to my_efo_ids</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">my_efo_ids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">my_efo_ids</span></span>
<span><span class="va">my_variants</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">my_efo_ids</span>, <span class="op">~</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>efo_id <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now you can see which variants are associated with each EFO identifier.</p>
<p>For <code>'EFO_0005543'</code> we got the following variants:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants</span><span class="op">[[</span><span class="st">'EFO_0005543'</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">variants</span><span class="op">$</span><span class="va">variant_id</span></span>
<span><span class="co">#&gt;  [1] "rs11706832"  "rs498872"    "rs72714270"  "rs11599775"  "rs12803321" </span></span>
<span><span class="co">#&gt;  [6] "rs7125115"   "rs10069690"  "rs12752552"  "rs648044"    "rs111976262"</span></span>
<span><span class="co">#&gt; [11] "rs11598018"  "rs4252707"   "rs688755"    "rs634537"    "rs78378222" </span></span>
<span><span class="co">#&gt; [16] "rs4975538"   "rs2297433"   "rs55705857"  "rs320337"    "rs10852606" </span></span>
<span><span class="co">#&gt; [21] "rs2297440"   "rs1938964"   "rs1106639"   "rs12076373"  "rs3772190"  </span></span>
<span><span class="co">#&gt; [26] "rs2235573"   "rs10842893"  "rs7572263"   "rs2736100"   "rs80351950" </span></span>
<span><span class="co">#&gt; [31] "rs5839764"   "rs77633900"  "rs3751667"   "rs7107785"   "rs72714236" </span></span>
<span><span class="co">#&gt; [36] "rs10131032"  "rs4774756"   "rs4977756"   "rs9841110"   "rs6010620"  </span></span>
<span><span class="co">#&gt; [41] "rs11233250"  "rs75061358"  "rs10927065"  "rs1275600"   "rs11979158"</span></span></code></pre></div>
<p>And for <code>'EFO_0004762'</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants</span><span class="op">[[</span><span class="st">'EFO_0004762'</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">variants</span><span class="op">$</span><span class="va">variant_id</span></span>
<span><span class="co">#&gt;  [1] "rs78355601"  "rs10411345"  "rs144085478" "rs12214617"  "rs181216459"</span></span>
<span><span class="co">#&gt;  [6] "rs118086804" "rs12456390"  "rs4714729"   "rs12199215"  "rs2639990"  </span></span>
<span><span class="co">#&gt; [11] "rs9472155"   "rs144160960" "rs34528081"  "rs4082730"   "rs7763358"  </span></span>
<span><span class="co">#&gt; [16] "rs55864163"  "rs9787438"   "rs150821445" "rs12445232"  "rs6598475"  </span></span>
<span><span class="co">#&gt; [21] "rs10934631"  "rs6475938"   "rs6479877"   "rs6921438"   "rs10886366" </span></span>
<span><span class="co">#&gt; [26] "rs10761741"  "rs114694170" "rs77961527"  "rs112215592" "rs117580153"</span></span>
<span><span class="co">#&gt; [31] "rs73872715"  "rs13206436"  "rs4782371"   "rs4513773"   "rs186725382"</span></span>
<span><span class="co">#&gt; [36] "rs139893147" "rs10153304"  "rs34524635"  "rs7043199"   "rs187918360"</span></span>
<span><span class="co">#&gt; [41] "rs11639051"  "rs1740073"   "rs71779653"  "rs34881325"  "rs181558074"</span></span>
<span><span class="co">#&gt; [46] "rs2375981"   "rs59706856"  "rs2304058"   "rs73418461"  "rs10761750" </span></span>
<span><span class="co">#&gt; [51] "rs8045833"   "rs10761731"  "rs7030781"   "rs180936035" "rs550057"   </span></span>
<span><span class="co">#&gt; [56] "rs9332599"   "rs75455100"  "rs143479231" "rs10822155"  "rs7767396"  </span></span>
<span><span class="co">#&gt; [61] "rs191332118" "rs186066666" "rs11392719"  "rs6993770"   "rs61818787" </span></span>
<span><span class="co">#&gt; [66] "rs144820908" "rs61829244"  "rs6722871"   "rs10738760"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-combine-results-from-multiple-queries">9 | How to combine results from multiple queries?<a class="anchor" aria-label="anchor" href="#how-to-combine-results-from-multiple-queries"></a>
</h2>
<p>The four main retrieval functions <code><a href="../reference/get_studies.html">get_studies()</a></code>, <code><a href="../reference/get_associations.html">get_associations()</a></code>, <code><a href="../reference/get_variants.html">get_variants()</a></code> and <code><a href="../reference/get_traits.html">get_traits()</a></code> all allow you to search multiple criteria at once. You can then combine results in an OR or AND fashion using the parameter <code>set_operation</code>.</p>
<p>Use <code>set_operation = 'union'</code> to combine results in an OR fashion:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants_OR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span></span>
<span>  efo_trait <span class="op">=</span> <span class="st">'triple-negative breast cancer'</span>,</span>
<span>  gene_name <span class="op">=</span> <span class="st">'MDM4'</span>,</span>
<span>  set_operation <span class="op">=</span> <span class="st">'union'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_variants_OR</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span>,</span>
<span>                       <span class="st">'chromosome_region'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 46 × 4</span></span>
<span><span class="co">#&gt;    variant_id  chromosome_name chromosome_position chromosome_region</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;            </span></span>
<span><span class="co">#&gt;  1 rs3747636   1                         204434531 1q32.1           </span></span>
<span><span class="co">#&gt;  2 rs10793765  1                         204580247 1q32.1           </span></span>
<span><span class="co">#&gt;  3 rs116661163 1                         204641544 1q32.1           </span></span>
<span><span class="co">#&gt;  4 rs12083887  1                         118339066 1p12             </span></span>
<span><span class="co">#&gt;  5 rs12143943  1                         204602943 1q32.1           </span></span>
<span><span class="co">#&gt;  6 rs1008833   1                         204457167 1q32.1           </span></span>
<span><span class="co">#&gt;  7 rs2137255   1                         204457245 1q32.1           </span></span>
<span><span class="co">#&gt;  8 rs2290854   1                         204546897 1q32.1           </span></span>
<span><span class="co">#&gt;  9 rs3789044   1                         204619973 1q32.1           </span></span>
<span><span class="co">#&gt; 10 rs12036042  1                         204500186 1q32.1           </span></span>
<span><span class="co">#&gt; # … with 36 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>The code above retrieves variants whose associated <code>efo_trait</code> is equal to <code>'triple-negative breast cancer'</code> or variants that are associated with gene <code>'MDM4'</code>.</p>
<p>Alternatively, we may use <code>set_operation = 'intersection'</code> to combine results in an AND fashion:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants_AND</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span></span>
<span>  efo_trait <span class="op">=</span> <span class="st">'triple-negative breast cancer'</span>,</span>
<span>  gene_name <span class="op">=</span> <span class="st">'MDM4'</span>,</span>
<span>  set_operation <span class="op">=</span> <span class="st">'intersection'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_variants_AND</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span>,</span>
<span>                       <span class="st">'chromosome_region'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;   variant_id chromosome_name chromosome_position chromosome_region</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;            </span></span>
<span><span class="co">#&gt; 1 rs4245739  1                         204549714 1q32.1</span></span></code></pre></div>
<p>With <code>set_operation = 'intersection'</code>, as in the code above, we get variants whose associated <code>efo_trait</code> is equal to <code>'triple-negative breast cancer'</code> and that are associated with gene <code>'MDM4'</code>, i.e., only variants meeting both conditions simultaneously are retrieved.</p>
<p>Please note that almost all search criteria to be used with the retrieval functions are vectorised, meaning that you can use multiple values with the same search criterion. In these cases results are always combined in an OR fashion.</p>
<p>In the following example, we will be using the gene name as the only search criterion. If we pass a vector of gene names then we get all variants that are associated with EITHER (OR) genes.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'RNU6-367P'</span>, <span class="st">'ABHD5'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_variants</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span>,</span>
<span>                       <span class="st">'chromosome_region'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 28 × 4</span></span>
<span><span class="co">#&gt;    variant_id  chromosome_name chromosome_position chromosome_region</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;            </span></span>
<span><span class="co">#&gt;  1 rs7625896   3                          44021069 3p21.33          </span></span>
<span><span class="co">#&gt;  2 rs142242702 3                          44122660 3p21.32          </span></span>
<span><span class="co">#&gt;  3 rs1554654   3                          44002852 3p21.33          </span></span>
<span><span class="co">#&gt;  4 rs7619427   3                          44035549 3p21.33          </span></span>
<span><span class="co">#&gt;  5 rs11718455  3                          44015406 3p21.33          </span></span>
<span><span class="co">#&gt;  6 rs73076675  3                          43924731 3p21.33          </span></span>
<span><span class="co">#&gt;  7 rs113706999 3                          44117664 3p21.32          </span></span>
<span><span class="co">#&gt;  8 rs6441814   3                          44007622 3p21.33          </span></span>
<span><span class="co">#&gt;  9 rs4017425   3                          43987272 3p21.33          </span></span>
<span><span class="co">#&gt; 10 rs79644353  3                          44135707 3p21.32          </span></span>
<span><span class="co">#&gt; # … with 18 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>In this case we retrieved 28 variants. Please note that the <code>set_operation</code> parameter does not affect this result. The <code>set_operation</code> only controls the function behaviour when combining results from different criteria, e.g., when using <code>efo_trait</code> and <code>gene_name</code>.</p>
<p>To retrieve variants that are concomitantly associated with genes RNU6-367P and ABHD5, the user needs to place these queries separately and then intersect them — using the <code><a href="../reference/setop.html">intersect()</a></code> function, i.e., combining in an AND fashion. Here we start by retrieving variants associated with gene RNU6-367P:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>gene_name <span class="op">=</span> <span class="st">'RNU6-367P'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_variants1</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span>,</span>
<span>                       <span class="st">'chromosome_region'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 14 × 4</span></span>
<span><span class="co">#&gt;    variant_id  chromosome_name chromosome_position chromosome_region</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;            </span></span>
<span><span class="co">#&gt;  1 rs7625896   3                          44021069 3p21.33          </span></span>
<span><span class="co">#&gt;  2 rs142242702 3                          44122660 3p21.32          </span></span>
<span><span class="co">#&gt;  3 rs1554654   3                          44002852 3p21.33          </span></span>
<span><span class="co">#&gt;  4 rs7619427   3                          44035549 3p21.33          </span></span>
<span><span class="co">#&gt;  5 rs11718455  3                          44015406 3p21.33          </span></span>
<span><span class="co">#&gt;  6 rs73076675  3                          43924731 3p21.33          </span></span>
<span><span class="co">#&gt;  7 rs113706999 3                          44117664 3p21.32          </span></span>
<span><span class="co">#&gt;  8 rs6441814   3                          44007622 3p21.33          </span></span>
<span><span class="co">#&gt;  9 rs4017425   3                          43987272 3p21.33          </span></span>
<span><span class="co">#&gt; 10 rs79644353  3                          44135707 3p21.32          </span></span>
<span><span class="co">#&gt; 11 rs7619544   3                          43852053 3p21.33          </span></span>
<span><span class="co">#&gt; 12 rs189710954 3                          43800315 3p21.33          </span></span>
<span><span class="co">#&gt; 13 rs35283240  3                          43990836 3p21.33          </span></span>
<span><span class="co">#&gt; 14 rs62251261  3                          44106761 3p21.32</span></span></code></pre></div>
<p>There are 14 variants associated with gene RNU6-367P. Now, for gene ABHD5:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_variants2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_variants.html">get_variants</a></span><span class="op">(</span>gene_name <span class="op">=</span> <span class="st">'ABHD5'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_variants2</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span>,</span>
<span>                       <span class="st">'chromosome_region'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 19 × 4</span></span>
<span><span class="co">#&gt;    variant_id  chromosome_name chromosome_position chromosome_region</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;            </span></span>
<span><span class="co">#&gt;  1 rs191867523 3                          43774449 3p21.33          </span></span>
<span><span class="co">#&gt;  2 rs115421670 3                          43737217 3p21.33          </span></span>
<span><span class="co">#&gt;  3 rs6772840   3                          43812828 3p21.33          </span></span>
<span><span class="co">#&gt;  4 rs11720728  3                          43832420 3p21.33          </span></span>
<span><span class="co">#&gt;  5 rs142404191 3                          43641812 3p21.33          </span></span>
<span><span class="co">#&gt;  6 rs192944990 3                          43826178 3p21.33          </span></span>
<span><span class="co">#&gt;  7 rs182923613 3                          43791731 3p21.33          </span></span>
<span><span class="co">#&gt;  8 rs73087085  3                          43687796 3p21.33          </span></span>
<span><span class="co">#&gt;  9 rs75594032  3                          43744082 3p21.33          </span></span>
<span><span class="co">#&gt; 10 rs1468602   3                          43701242 3p21.33          </span></span>
<span><span class="co">#&gt; 11 rs4082244   3                         135010695 3q22.2           </span></span>
<span><span class="co">#&gt; 12 rs740838    3                          43722823 3p21.33          </span></span>
<span><span class="co">#&gt; 13 rs73076675  3                          43924731 3p21.33          </span></span>
<span><span class="co">#&gt; 14 rs141365045 3                          43691004 3p21.33          </span></span>
<span><span class="co">#&gt; 15 rs4017425   3                          43987272 3p21.33          </span></span>
<span><span class="co">#&gt; 16 rs17075898  3                          43710695 3p21.33          </span></span>
<span><span class="co">#&gt; 17 rs7619544   3                          43852053 3p21.33          </span></span>
<span><span class="co">#&gt; 18 rs189710954 3                          43800315 3p21.33          </span></span>
<span><span class="co">#&gt; 19 rs35283240  3                          43990836 3p21.33</span></span></code></pre></div>
<p>There are 19 variants associated with gene ABHD5. To find those variants simultaneously associated with both genes, you can intersect the two <a href="https://rmagno.eu/gwasrapidd/reference/variants-class.html">variants</a> objects using <code><a href="../reference/setop.html">gwasrapidd::intersect()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variants_intersect</span> <span class="op">&lt;-</span> <span class="fu">gwasrapidd</span><span class="fu">::</span><span class="fu"><a href="../reference/setop.html">intersect</a></span><span class="op">(</span><span class="va">my_variants1</span>, <span class="va">my_variants2</span><span class="op">)</span></span>
<span><span class="va">variants_intersect</span><span class="op">@</span><span class="va">variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'variant_id'</span>,</span>
<span>                       <span class="st">'chromosome_name'</span>,</span>
<span>                       <span class="st">'chromosome_position'</span>,</span>
<span>                       <span class="st">'chromosome_region'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 4</span></span>
<span><span class="co">#&gt;   variant_id  chromosome_name chromosome_position chromosome_region</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;            </span></span>
<span><span class="co">#&gt; 1 rs73076675  3                          43924731 3p21.33          </span></span>
<span><span class="co">#&gt; 2 rs4017425   3                          43987272 3p21.33          </span></span>
<span><span class="co">#&gt; 3 rs7619544   3                          43852053 3p21.33          </span></span>
<span><span class="co">#&gt; 4 rs189710954 3                          43800315 3p21.33          </span></span>
<span><span class="co">#&gt; 5 rs35283240  3                          43990836 3p21.33</span></span></code></pre></div>
<p>Apparently only 5 variant(s) are related to both genes RNU6-367P and ABHD5.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://rmagno.eu/" class="external-link">Ramiro Magno</a>, Ana-Teresa Maia, <a href="https://cintesis.eu/" class="external-link"><img src="https://maialab.org/gwasrapidd/reference/figures/cintesis.svg" height="24"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
